jQuery(function(o){o.colorpicker.parts.memory=function(e){var r,c=function(r){e._setColor(o(r).css("backgroundColor")),e._change()},i=function(o){o.remove()},t=function(e){var t=o("<div/>").addClass("ui-colorpicker-swatch").css("backgroundColor",e);t.mousedown(function(o){switch(o.stopPropagation(),o.which){case 1:c(this);break;case 3:i(t),setMemory()}}).bind("contextmenu",function(o){o.preventDefault()}),r.append(t)},n=function(){if(window.localStorage){var e=localStorage.getItem("colorpicker-memory");if(e)return JSON.parse(e)}return o.map((document.cookie.match(/\bcolorpicker-memory=([^;]*)/)||[0,""])[1].split(","),unescape)};setMemory=function(){var e=[];if(o("> *",r).each(function(){e.push(o(this).css("backgroundColor"))}),window.localStorage)localStorage.setItem("colorpicker-memory",JSON.stringify(e));else{var c=new Date;c.setDate(c.getDate()+3650),document.cookie="colorpicker-memory="+o.map(e,escape).join()+";expires="+c.toUTCString()}},this.init=function(){r=o("<div/>").addClass("ui-colorpicker-memory ui-colorpicker-border ui-colorpicker-swatches").css({width:84,height:84,cursor:"crosshair"}).appendTo(o(".ui-colorpicker-memory-container",e.dialog)),o.each(n(),function(){t(this)}),r.mousedown(function(){t(e.color.toCSS()),setMemory()})}}});