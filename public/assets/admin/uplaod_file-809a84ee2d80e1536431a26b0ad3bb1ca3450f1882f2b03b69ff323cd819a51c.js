function _upload_file(){this.drop_stop=function(e){e.stopPropagation(),e.preventDefault()},this.get_file_drop=function(e,t){this.drop_stop(e);var a=e.originalEvent.dataTransfer.files[0],n=$(t).attr("url");this.upload(a,n)},this.get_file=function(e,t){var a=e.target.files[0],n=$(t).attr("url");this.upload(a,n)},this.upload=function(e,t){var a=new FormData;a.append("file",e),a.append("authenticity_token",authenticity_token),n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");var n=new XMLHttpRequest;n.open("POST",t,!0),n.onload=function(){if(200===n.status)switch(response=JSON.parse(n.responseText),alert(response.callback),response.callback){case"excel":excel.get_files(),$("#file_input").val("")}else alert("b\u0142\u0105d - podczas wywo\u0142ania funkcji excela"),alert(n.responseText)},n.send(a)}}