function _map(){this.list=null,this.id=null,this.check=function(){null==this.list?this.get_files():("maps"==popup.target_name&&this.show_files(),"project-maps"==popup.target_name&&this.project_show_files())},this.get_files=function(){var a=this;$.ajax({url:"/rest/map",type:"GET",success:function(s){a.list=s,"maps"==popup.target_name&&a.show_files(),"project-maps"==popup.target_name&&a.project_show_files()}})},this.open=function(a){var s=this;this.id==a?s.add():$.ajax({url:"/rest/map/"+a,type:"GET",success:function(t){$("#add_map").is(":visible")||s.add(),s.id=a,$('input[name="name"]').val(t.name),$('textarea[name="map_json"]').val(t.map_json),$("#add_map #preview_map").html(t.map_json)}})},this.open2=function(a){var s=this;$.ajax({url:"/rest/map/"+a,type:"GET",success:function(t){s.id=a,console.log("obiekt pobranej mapy: "+t),$("#project-edit .map_window .project").html(t.map_json)}})},this.save=function(){var a=this;if(null==this.id)$.ajax({url:"/rest/map/",type:"POST",data:{name:$('#maps input[name="name"]').val(),map_json:$('#maps textarea[name="map_json"]').val(),authenticity_token:authenticity_token},success:function(s){a.get_files(),console.log("tworzymy now\u0105 map\u0119"+s)},error:function(a){console.log("tworzymy now\u0105 map\u0119"+a)}});else{var a=this;$.ajax({url:"/rest/map/"+a.id,type:"PUT",data:{name:$('#maps input[name="name"]').val(),map_json:$('#maps textarea[name="map_json"]').val(),authenticity_token:authenticity_token},success:function(s){a.get_files(),console.log("aktualizujemy map\u0119"+s)},error:function(a){console.log("aktualizujemy map\u0119"+a)}})}},this["delete"]=function(){var a=this;$.ajax({url:"/rest/map/"+a.id,type:"DELETE",data:{authenticity_token:authenticity_token},success:function(s){a.get_files(),console.log("usuwamy map\u0119"+s)},error:function(a){console.log("usuwamy map\u0119"+a)}})},this.add=function(){$('#maps input[name="name"]').val(""),$('#maps textarea[name="map_json"]').val(""),$("#add_map").is(":visible")?$("#add_map").slideUp(500):$("#add_map").slideDown(500)},this.show_files=function(){var a=this;$("#maps .maps_list").html(""),$.each(this.list,function(s,t){$("#maps .maps_list").append('<div class="map" id="'+t.id+'" ><span>'+t.name+"</span></div>"),$("#maps .maps_list .map:last-child").delay(80*s).fadeIn(200),a.index=s}),$("#maps .maps_list").css("background","none"),$("#maps .maps_list").append('<div class="map add"><span>nowy mapa</span></div>'),$("#maps .maps_list div:last-child").delay(80*this.index).fadeIn(200)},this.project_show_files=function(){var a=this;$("#project-maps .maps_list").html(""),$.each(this.list,function(s,t){$("#project-maps .maps_list").append(project.map_id==t.id?'<div class="map" style="border-top:5px solid red" id="'+t.id+'" ><span>'+t.name+"</span></div>":'<div class="map" id="'+t.id+'" ><span>'+t.name+"</span></div>"),$("#project-maps .maps_list .map:last-child").delay(80*s).fadeIn(200),a.index=s}),$("#project-maps .maps_list").css("background","none"),$("#project-maps .maps_list").append('<div class="map add"><span>nowy mapa</span></div>'),$("#project-maps .maps_list div:last-child").delay(80*this.index).fadeIn(200)}}